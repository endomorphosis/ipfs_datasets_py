[pytest]
# Dedicated pytest configuration for the ipfs_datasets_py subproject.
# Consolidated into a single section (duplicate [pytest] sections break pytest).

python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

testpaths =
    tests

addopts =
    -v
    --tb=short
    --strict-markers
    --import-mode=importlib

pythonpath = . .venv ipfs_accelerate_py

asyncio_mode = auto
anyio_mode = asyncio

filterwarnings =
    ignore::DeprecationWarning
    ignore::UserWarning

norecursedirs =
    .git
    .tox
    dist
    build
    *.egg
    test_stubs_from_gherkin
    gherkin_features
    tests/unit/test_stubs_from_gherkin
    tests/unit/gherkin_features

markers =
    unit: Unit tests
    integration: Integration tests
    slow: Slow running tests
    llm: Requires an LLM or LLM-weighted dependencies; skipped unless enabled
    network: Requires network access; skipped unless enabled
    heavy: Resource-heavy (GPU/large models/large datasets); skipped unless enabled
    gpu: mark test as requiring GPU (CUDA)
    multi_gpu: mark test as requiring multiple GPUs (2+)
    trio: mark test to run with trio backend

cache_dir = .pytest_cache